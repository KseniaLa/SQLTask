# SQLTask
**SCRIPTS** folder contains scripts of all database objects (generated by SSMS). <br/>
**EXECUTION PLAN** folder contains initial and optimized queries as well as Execution Plan screenshots. <br/><br/>

## Task files

1.
>Создание пользователя


dbo.CreateUser.StoredProcedure.sql

2.

>Создание блога


dbo.CreateBlog.StoredProcedure.sql

3.

>Оплата блога


dbo.PayBlog.StoredProcedure.sql

4.

>Добавление статьи к блогу


dbo.AddArticle.StoredProcedure.sql

5.

>Добавление рейтинга к статье. рейтинг может быть выставлен от 1 до 5, причем один и тот же пользователь может сделать это только 1 раз. Выставить значения меньше 1 и больше 5 нельзя. При повторном выставлении рейтинга должен обновляться сущесвующий, либо добавляться новый если пользователь еще не оставлял рейтинг для статьи. При выставлении рейтинг должен пересчитываться средний рейтинг для статьи, на основе оставленных рейтингов всеми пользователями


dbo.AddRating.StoredProcedure.sql

6.

>Поиск статей, дата создания которых больше переданной даты. Вывести инфморацию о блоге, пользователе и количестве комментариев для каждой найденной статьи


dbo.GetArticlesAfterDate.StoredProcedure.sql

7.

>Вывести список пользователей и средний рейтинг по ВСЕМ его статьям. Если у статьи нет рейтинга, то не использовать ее в подсчете среднего по всем статьям


dbo.UserArticlesRaiting.View.sql

8.

>Выбрать все неоплаченные блоги и данные о создателях этих блогов. Должно быть включено количество заблокированных статей в блоге, открытых для просмотра, и общее количество статей в блоге и средний рейтинг блога как средний рейтинг по всем статьям этого блога. Если у статьи нет рейтинга, то не использовать ее в подсчете среднего по всем статьям


dbo.UnpaidBlogs.View.sql

## Execution plan <br/>

Execution plan was analyzed for queries from the following database objects: UnpaidBlogs View, UserArticlesRaiting View, GetArticlesAfterDate Stored Procedure. Each Execution Plan screenshot is divided into two files (part1 and part2). Screenshots with "Comparison" prefix show which query is more efficient.
